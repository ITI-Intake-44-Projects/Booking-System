@using System.Diagnostics
@model List<MostVisitedPlacesViewModel>

@{
    ViewData["Title"] = "Home Page";
    Layout = "_LoggedLayout";
    var i = 1;
}

<!-- Carousel Start -->
<div class="carousel-header">
    <div id="carouselId" class="carousel slide" data-bs-ride="carousel">
        <ol class="carousel-indicators">
            <li data-bs-target="#carouselId" data-bs-slide-to="0" class="active"></li>
            <li data-bs-target="#carouselId" data-bs-slide-to="1"></li>
            <li data-bs-target="#carouselId" data-bs-slide-to="2"></li>
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
                <img src="img/carousel-2.jpg" class="img-fluid" alt="Image">
                <div class="carousel-caption">
                    <div class="p-3" style="max-width: 900px;">
                        <h4 class="text-white text-uppercase fw-bold mb-4" style="letter-spacing: 3px;">Explore The World</h4>
                        <h1 class="display-2 text-capitalize text-white mb-4">Let's The World Together!</h1>
                        <p class="mb-5 fs-5">
                            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                        </p>
                        <div class="d-flex align-items-center justify-content-center">
                            <a class="btn-hover-bg btn btn-primary rounded-pill text-white py-3 px-5" href="#">Discover Now</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img src="img/carousel-1.jpg" class="img-fluid" alt="Image">
                <div class="carousel-caption">
                    <div class="p-3" style="max-width: 900px;">
                        <h4 class="text-white text-uppercase fw-bold mb-4" style="letter-spacing: 3px;">Explore The World</h4>
                        <h1 class="display-2 text-capitalize text-white mb-4">Find Your Perfect Tour At Travel</h1>
                        <p class="mb-5 fs-5">
                            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                        </p>
                        <div class="d-flex align-items-center justify-content-center">
                            <a class="btn-hover-bg btn btn-primary rounded-pill text-white py-3 px-5" href="#">Discover Now</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img src="img/carousel-3.jpg" class="img-fluid" alt="Image">
                <div class="carousel-caption">
                    <div class="p-3" style="max-width: 900px;">
                        <h4 class="text-white text-uppercase fw-bold mb-4" style="letter-spacing: 3px;">Explore The World</h4>
                        <h1 class="display-2 text-capitalize text-white mb-4">You Like To Go?</h1>
                        <p class="mb-5 fs-5">
                            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                        </p>
                        <div class="d-flex align-items-center justify-content-center">
                            <a class="btn-hover-bg btn btn-primary rounded-pill text-white py-3 px-5" href="#">Discover Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselId" data-bs-slide="prev">
            <span class="carousel-control-prev-icon btn bg-primary" aria-hidden="false"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselId" data-bs-slide="next">
            <span class="carousel-control-next-icon btn bg-primary" aria-hidden="false"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>
<!-- Carousel End -->
<!--search bar start-->
<div class="container-fluid search-bar position-relative" style="top: -50%; transform: translateY(-50%);">
    <div class="container">
        <form asp-action="Index" asp-controller="Search" method="post" enctype="multipart/form-data">
            <div class="position-relative rounded-pill w-100 mx-auto p-5" style="background: rgba(19, 53, 123, 0.8);">
                <input class="form-control border-0 rounded-pill w-100 py-3 ps-4 pe-5" type="text" placeholder="Eg: Thailand" name="city">
                <input name="dates" placeholder="checkout/in" type="text" class="btn btn-primary position-absolute  border-0 rounded " style="top:110px;left:50%;transform:translateX(-50%) " />
                <button type="submit" class="btn btn-primary rounded-pill py-2 px-4 position-absolute me-2" style="top: 50%; right: 46px; transform: translateY(-50%);">Search</button>
            </div>
        </form>
    </div>
</div>
<!--search bar end-->

<!-- Destination Start -->
<div class="container-fluid destination py-5">
    <div class="container py-5">
        <div class="mx-auto text-center mb-5" style="max-width: 900px;">
            <h5 class="section-title px-3">Destination</h5>
            <h1 class="mb-0">Popular Destinations</h1>
        </div>
        <div class="tab-class text-center">
            <ul class="nav nav-pills d-inline-flex justify-content-center mb-5">
                <li class="nav-item">
                    <a class="d-flex mx-3 py-2 border border-primary bg-light rounded-pill nav-link active" 
                        data-bs-toggle="pill" href="#tab-All" data-country="All">
                        <span class="text-dark" style="width: 150px;">All</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="d-flex mx-3 py-2 border border-primary bg-light rounded-pill nav-link"
                       data-bs-toggle="pill" href="#tab-Egypt" data-country="Egypt">
                        <span class="text-dark" style="width: 150px;">Egypt</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="d-flex mx-3 py-2 border border-primary bg-light rounded-pill nav-link"
                       data-bs-toggle="pill" href="#tab-Morocco" data-country="Morocco">
                        <span class="text-dark" style="width: 150px;">Morocco</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="d-flex mx-3 py-2 border border-primary bg-light rounded-pill nav-link"
                       data-bs-toggle="pill" href="#tab-USA" data-country="USA">
                        <span class="text-dark" style="width: 150px;">USA</span>
                    </a>
                </li>
            </ul>
            <div class="row g-2 tab-content" id="big">
                @foreach (var place in Model)
                {
                    <div id="tab-@i" class="cities tab-pane fade show active m-3 col-lg-4">
                        <div style="height:300px" class="destination-img">
                            <img style="height:100%;width:100%;object-fit:cover;object-position:center" class="loaded-image img-fluid rounded w-100" src="data:image/jpg;base64,@place.CityImage" alt="@place.CityName">
                            <div class="destination-overlay p-3">
                                <h4 class="loaded-image-name text-white mb-2 mt-3">@place.CityName</h4>
                                <a href="#" class="btn-hover-text-warning text-white">View All Hotels 
                                    <i class="fa fa-arrow-right ms-2"></i>
                                </a>
                            </div>
                            <div class="search-icon">
                                <a href="@place." data-lightbox="@place.CityName">
                                    <i class="fa fa-plus-square fa-1x btn btn-light btn-lg-square text-primary"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    i++;
                }
            </div>
        </div>
    </div>
</div>
<!-- Destination End -->

<!-- cities start -->
<div class="container-fluid ExploreTour py-5">
    <div class="container py-5">
        <div class="mx-auto text-center mb-5" style="max-width: 900px;">
            <h5 class="section-title px-3">Places</h5>
            <h1 class="mb-4">whatever makes you comfortable</h1>

        </div>
        <div class="tab-class text-center">

            <div class="tab-content">
                <div id="NationalTab-1" class="tab-pane fade show p-0 active">
                    <div class="row g-4">
                        <div class="col-md-6 col-lg-4">
                            <div class="national-item">
                                <img src="img/explore-tour-1.jpg" class="img-fluid w-70 rounded" alt="Image">
                                <div class="national-content">
                                    <div class="national-info">
                                        <h5 class="text-white text-uppercase mb-2">Apartment</h5>
                                        <a href="#" class="btn-hover text-white">View All Place <i class="fa fa-arrow-right ms-2"></i></a>
                                    </div>
                                </div>
                                <div class="national-plus-icon">
                                    <a href="#" class="my-auto"><i class="fas fa-link fa-2x text-white"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-4">
                            <div class="national-item">
                                <img src="img/explore-tour-2.jpg" class="img-fluid w-100 rounded" alt="Image">
                                <div class="national-content">
                                    <div class="national-info">
                                        <h5 class="text-white text-uppercase mb-2">Hotels</h5>
                                        <a href="#" class="btn-hover text-white">View All Place <i class="fa fa-arrow-right ms-2"></i></a>
                                    </div>
                                </div>
                                <div class="national-plus-icon">
                                    <a href="#" class="my-auto"><i class="fas fa-link fa-2x text-white"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-4">
                            <div class="national-item">
                                <img src="img/explore-tour-3.jpg" class="img-fluid w-100 rounded" alt="Image">
                                <div class="national-content">
                                    <div class="national-info">
                                        <h5 class="text-white text-uppercase mb-2">villas</h5>
                                        <a href="#" class="btn-hover text-white">View All Place <i class="fa fa-arrow-right ms-2"></i></a>
                                    </div>
                                </div>
                                <div class="tour-offer bg-info">15% Off</div>
                                <div class="national-plus-icon">
                                    <a href="#" class="my-auto"><i class="fas fa-link fa-2x text-white"></i></a>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<!-- cities end -->


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />


<script>
    $('input[name="dates"]').daterangepicker();
</script>

<script>
    var big = document.getElementById('big');
    var cities = document.querySelectorAll('.cities');
    function loadImages(countryName)
    {
        big.innerHTML = "";
        if (countryName == "All") {
            big.append(...cities);
            console.log(cities);
        } 
        else 
        {
            $.ajax({
                url: '/Home/RenderImagesUsingAJAX',
                type: 'GET',
                data: { countryName: countryName },
                success: function (data) {

                    for (let idx = 0; idx < data.length; idx++){
                        var cityElement = cities[idx].cloneNode(true);
                        big.append(cities[idx]);
                        cityElement.querySelector(".loaded-image").src = 'data:image/jpg;base64,' + data[idx]._image;
                        cityElement.querySelector(".loaded-image-name").innerHTML = data[idx]._name;
                        console.log("name " + data[idx]._name);
                        console.log(cities);
                    }
                }, 
                error: function (xhr, status, error) {
                    console.error('Error:', error);
                    $('#tab-' + countryName + ' .tab-pane').html('<p>Error loading images. Please try again later.</p>');
                }
            });
            console.log("test");
        }
    }
    $('.nav-link').click(function () {
        var countryName = $(this).data('country');
        loadImages(countryName);
    });
</script>

<!--ajax start-->
@* <script>
    $(document).ready(function () {
        function loadImagesForCountry(CountryName) {
            $.ajax({
                url: '/Home/RenderImagesUsingAJAX',
                type: 'GET',
                data: { CountryName: CountryName },
                success: function (data) {
                    $('.destination-img').empty();
                    var tabContent = $('#tab-' + CountryName + ' .tab-pane');
                    tabContent.empty();
                    if (!data || data.length === 0) {
                        tabContent.html('<p>No images found for this country.</p>');
                    } else {
                        data.forEach(function (img) {
                            var destinationImgDiv = $('<div>', {
                                'class': 'tab-pane fade show m-3 col-lg-4'
                            });

                            var destinationImgContainer = $('<div>', {
                                'class': 'destination-img'
                            });

                            var imageElement = $('<img>', {
                                'src': 'data:image/jpg;base64,' + img,
                                'class': 'img-fluid rounded w-100',
                                'alt': 'City Image'
                            });

                            var overlayElement = $('<div>', {
                                'class': 'destination-overlay p-3'
                            }).append(
                                $('<h4>', {
                                    'class': 'text-white mb-2 mt-3',
                                    'text': 'City Name'
                                }),
                                $('<a>', {
                                    'href': '#',
                                    'class': 'btn-hover-text-warning text-white',
                                    'text': 'View All Hotels'
                                }).append($('<i>', {
                                    'class': 'fa fa-arrow-right ms-2'
                                }))
                            );

                            var searchIconElement = $('<div>', {
                                'class': 'search-icon'
                            }).append(
                                $('<a>', {
                                    'href': '#',
                                    'data-lightbox': 'City Name'
                                }).append($('<i>', {
                                    'class': 'fa fa-plus-square fa-1x btn btn-light btn-lg-square text-primary'
                                }))
                            );

                            destinationImgContainer.append(imageElement, overlayElement, searchIconElement);
                            destinationImgDiv.append(destinationImgContainer);
                            tabContent.append(destinationImgDiv);
                        });
                    }
                    console.log("Images loaded for " + CountryName + "!");
                },
                error: function (xhr, status, error) {
                    console.error('Error:', error);
                    $('#tab-' + CountryName + ' .tab-pane').html('<p>Error loading images. Please try again later.</p>');
                }
            });
        }

        $('.nav-link').click(function () {
            var countryName = $(this).data('country');
            loadImagesForCountry(countryName);
        });
    });
</script> *@
<!-- ajax end-->
